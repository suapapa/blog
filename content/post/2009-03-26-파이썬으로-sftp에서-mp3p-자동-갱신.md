---
title: 파이썬으로 sftp에서 MP3P 자동 갱신
author: suapapa
type: post
date: 2009-03-26T07:32:09+00:00
url: /p=202
translations:
  - 'a:1:{i:0;s:5648:"YToxOntzOjI6ImtvIjthOjI6e3M6MTI6InBvc3RfY29udGVudCI7czo0MTE0OiI8cD7rp47snYAg67aE65Ok7J20IO2ZiOyEnOuyhOulvCDthrXtlbQgbW1zIOyKpO2KuOumvOydhCDrhbnsnYztlZjqs6Ag6rOE7IugIOqxuOuhnCDslYzqs6Ag7J6I7Iq164uI64ukLjwvcD4NCjxwPuyggOuPhCBFQlMg652865SU7Jik6rCAIG1tc+yEnOu5hOyKpOulvCDsoJHquLAg7KCEIOq5jOyngCBFQlMg652865SU7Jik66W8IO2Gte2VtCDsmIHslrTqs7XrtoDrpbwg7ZWY64qU642wIOydtOulvCDtmZzsmqntlZjqs6Ag7J6I7JeI7KeA7JqUPC9wPg0KPGJsb2NrcXVvdGU+DQo8cD7qt7gg67Cp67KV7J2AIOqzoOyImOuvvCDri5jsnZgg67iU66Gc6re4IOykkSA8YSBocmVmPVxcJnF1b3Q7aHR0cDovL2tvLnVzbWxlbGlicmFyeS5jb20vZW50cnkvcmFkaW8tZW5nbGlzaFxcJnF1b3Q7PuudvOuUlOyYpOuhnCDsmIHslrTqs7XrtoAg7KCc64yA66GcIO2VmOuKlCDrspU8L2E+7JeQIOyemCDrgpjsmYAg7J6I7Iq164uI64ukLiA6KTwvcD4NCjwvYmxvY2txdW90ZT4NCjxwPkVCUyDrnbzrlJTsmKTripQg7ZmI7Y6Y7J207KeAIOqwnO2OuCDtm4Tsl5AgLSDrsJTrs7TqsJnsnbTrj4QtIEFjdGl2ZVjrpbwg7IKs7Jqp7ZW0IOyKpO2KuOumrOuwjSDrsKnshqHsnYQg7ZWY6rOgIOyeiOyKteuLiOuLpC48L3A+DQo8YmxvY2txdW90ZT4NCjxwPktMRFDsnZggYnVzaGnri5gg6ruY7IScIOqzhOyGjSDrpqzriIXsiqTrsJXsiqTsl5DshJwg65Ok7J2EIOyImCDsnojripQgPGEgaHJlZj1cXCZxdW90O2h0dHA6Ly9rbGRwLm9yZy9ub2RlLzk1OTc0XFwmcXVvdDs+6ri4PC9hPuydhCDsl7TslrQg7KO87IWo7Iq164uI64ukISEg6rCQ7IKs7ZWp64uI64ukLiAoX18pPC9wPg0KPC9ibG9ja3F1b3RlPg0KPHA+7ZWY7KeA66eMIOuzuOyduOydgCwg7JWE64uI6rys7JmA7IScLCDqt7gg7KaI7J2M67aA7YSwIOyLnOyeke2VnCBFbmdsaXNoIG9ubHkg67Cp7IahLCA8YSBocmVmPVxcJnF1b3Q7aHR0cDovL3Ric2VmbS5zZW91bC5rci9cXCZxdW90Oz50YnMgZUZNPC9hPuydmCA8YSBocmVmPVxcJnF1b3Q7aHR0cDovL3Ric2VmbS5zZW91bC5rci9lZm0vb3V0YnRfaW50cm8uanNwP2lkPW91dGJ0XFwmcXVvdDs+T3V0IE9mIEJlZCB3aXRoIFRyYXZpczwvYT7rpbwg65Oj6rOgIOyeiOyKteuLiOuLpC4gdGJzIGVGTeydmCDrsKnshqHrk6TsnYAg7JWE7KeBIERK65Ok7J20IOyEnO2ItOyWtCDrs7TsnbTripQg7KCQ64+EIOyeiOyngOunjCwg67O064ukIOyLpOyghCDsmIHslrTsl5Ag6rCA6rmM7JuMIOynhCDripDrgozsnbTrqbAsIOydjOyVheuPhCDti4DslrTspI3ri4jri6QuIOyYpOyYiH48L3A+DQo8cD7rhbnsnYzrsKnrspXsnYAgPGEgaHJlZj1cXCZxdW90O2h0dHA6Ly93d3cuc3VhcGFwYS5uZXQvd29yZHByZXNzLz9wPTMyXFwmcXVvdDs+7JiI7KCE6rO8IOuPmeydvDwvYT7tlanri4jri6QuIOyekOyEuO2VnCDshKTrqoXsnYAg7IOd65617ZWY6rOgLCB0YnMgZUZN7J2YIG1tcyDso7zshozripQg64uk7J2M6rO8IOqwmeyKteuLiOuLpC48L3A+DQo8dWw+DQogICAgPGxpPjxzdHJvbmc+bW1zOi8vNTguMjI3LjExNi4yNDkvZUZNPC9zdHJvbmc+PC9saT4NCjwvdWw+DQo8cD7snpAg6re465+8LiDtmYjshJzrsoTsl5Ag64Kg7J6Q67OE66GcIG1wM+2MjOydvOuTpOydtCDsjJPsl6wg7J6I6rKMIOuQmOqzoCwgc2Z0cOulvCDthrXtlbQg64uk7Jq067Cb7JWEIE1QM1DroZwg7Jiu6rKoIOuTo+qzpCDtlZjsmIDsirXri4jri6QuPC9wPg0KPHA+7Ja07JqwLi4uIOydtOqyjCDsnYDqt7ztnogg6reA7LCu6ri4656YIOyKpO2BrOumve2KuOulvCDsjagg67Sk7Iq164uI64ukLjwvcD4NCjxwPjwhLS1tb3JlLS0+PC9wPg0KPHA+64uk7J2MIOunge2BrOyXkOyEnCDri6TsmrQg67Cb7Jy87IS47JqULjwvcD4NCjx1bD4NCiAgICA8bGk+PGEgaHJlZj1cXCZxdW90O2h0dHA6Ly93ZWIuc3VhcGFwYS5uZXQ6ODA4MC9zdm4vT25lRmlsZXIvVXBkYXRlU29uZ3NGcm9tU2Z0cC5weVxcJnF1b3Q7PjxzdHJvbmc+VXBkYXRlU29uZ3NGcm9tU2Z0cC5weTwvc3Ryb25nPjwvYT48L2xpPg0KPC91bD4NCjxwPuygnOqwgCDtlYTsmpTtlojrjZgg6riw64ql65Ok7J2AIOuLpOydjOqzvCDqsJnsirXri4jri6QuPC9wPg0KPHVsPg0KICAgIDxsaT7sm5DtgbTrpq3snLzroZwg7ZmI7ISc67KE7J2YIHNmdHDrpbwg7Ya17ZW0IG1wM+2MjOydvOuTpOydhCDri6TsmrQt6rCx7IugLSDtlbQg7KSEIOqygzwvbGk+DQogICAgPGxpPm1wMyDtlIzroIjsnbTslrTsl5Ag64Sj6rOgIOuLpOuLkOunjO2BvCDsnpHsnYTqsoM8L2xpPg0KICAgIDxsaT7snIjrj4Qv66as64iF7Iqk7JeQ7IScIOuqqOuRkCDsi6Ttlokg6rCA64ql7ZWgIOqygzwvbGk+DQo8L3VsPg0KPHA+7YyM7J207I2s6rO8IHNzaDIg65287J2067iM65+s66asIDxhIGhyZWY9XFwmcXVvdDtodHRwOi8vd3d3LmxhZy5uZXQvcGFyYW1pa28vXFwmcXVvdDs+cGFyYW1pa288L2E+66W8IOyCrOyaqe2VmOyXrCDsnITsnZgg7KGw6rG07J2EIOuqqOuRkCDstqnsobHsi5ztgqwg7IiYIOyeiOyXiOyKteuLiOuLpC48L3A+DQo8YmxvY2txdW90ZT4NCjxwPuyciOuPhOyXkOyEnCBwYXJhbWlrb+ulvCDsgqzsmqntlZjroKTrqbAgUHVUVFnqsIAg7ZWE7JqU7ZWp64uI64ukLiDqt7gg67CW7JeQ64qUIE9T66W8IOqwgOumrOyngCDslYrqs6Ag64+Z7J287ZWcIOy9lOuTnOuhnCDrj5nsnpHtlanri4jri6QuIOyYpOyYiH48L3A+DQo8L2Jsb2NrcXVvdGU+DQo8cD7ri6TsnYzsnYAg7KCcIE1QM1Drpbwg7Jew6rKw7ZWcIO2ZlOuptDo8L3A+DQo8cD4mbmJzcDs8aW1nIGhlaWdodD1cXCZxdW90OzI0MlxcJnF1b3Q7IHdpZHRoPVxcJnF1b3Q7NDIwXFwmcXVvdDsgYWx0PVxcJnF1b3Q7XFwmcXVvdDsgc3JjPVxcJnF1b3Q7L3dvcmRwcmVzcy93cC1jb250ZW50L3VwbG9hZHMvaW1hZ2UvbXAzcF9maWxlcy5wbmdcXCZxdW90OyAvPjwvcD4NCjxwPuyekOuPmSDsl4XrjbDsnbTtirgg7Iqk7YGs66a97Yq47JmAIHNzaDIg6rCc7J247YKk66W8IOuEo+yWtOuRkOyWtCDtjIzsnbTsjazqs7wgcGFyYW1pa2/qsIAg6rmU66awIOqzsyjsoJzqsIAg7JOw64qUIFBD65Ok7JeQ64qUIOuqqOuRkCDquZTroKQg7J6I7Iq164uI64ukLinsnbTrnbzrqbQg7Ja065SU7ISc65OgIOykgOu5hOyZhOujjCDsnoXri4jri6QuIOy2lOqwgCDsmqnrn4nsnYAg64uoIDVrPC9wPg0KPHA+7JyI64+E7JeQ7ISgIO2MjOydtOyNrCDshKTsuZjsi5wgcHkg7ZmV7J6l7J6Q6rCAIO2MjOydtOyNrCDsnbjthLDtlITrpqzthLDsl5Ag7Jew6rKw65CY7Ja0IOyKpO2BrOumve2KuOulvCDrjZTruJQg7YG066at7ZWY64qUIOqygyDrp4zsnLzroZwg7Iuk7ZaJIOuQqeuLiOuLpC48L3A+DQo8cD7ri6TsnYzsnYAg7J6Q64+ZIOyXheuNsOydtO2KuCDsiqTtgazrpr3tirjsnZgg7Iuk7ZaJIOyepeuptDo8L3A+DQo8cD48aW1nIGhlaWdodD1cXCZxdW90OzIyOVxcJnF1b3Q7IHdpZHRoPVxcJnF1b3Q7NDE5XFwmcXVvdDsgYWx0PVxcJnF1b3Q7XFwmcXVvdDsgc3JjPVxcJnF1b3Q7L3dvcmRwcmVzcy93cC1jb250ZW50L3VwbG9hZHMvaW1hZ2UvbXAzcF9hdXRvX3VwZGF0ZV92aWFfc2Z0cC5wbmdcXCZxdW90OyAvPjwvcD4NCjxwPjPsnbzrp4zsnZgg7Iuk7ZaJIO2ZlOuptOydtOuEpOyalC4g7J207KCEIO2MjOydvOuTpOydhCDsp4DsmrDqs6Ag7IOIIO2MjOydvOuTpCAz6rCc66W8IOuLpOyatOuwm+qzoCDsnojsirXri4jri6QuIHBhcmFtaWtvMS43LjQg67KE7KC867aA7YSw64qUIHNmdHDsnZgg7KCE7IahIOyDge2DnOulvCBDQiDtlajsiJjsl5Ag6rG064Sk7KSEIOyImCDsnojqsowg65CY7Ja0LCA8YSBocmVmPVxcJnF1b3Q7aHR0cDovL2Jicy5weXRob24ub3Iua3Ivdmlld3RvcGljLnBocD90PTE0NjQ3XFwmcXVvdDs+7YyM7J207I2sIOyGjOumrOuwlOuLpCDtgbTrnbzsnbTslrjtirjsl5Ag7IKs7Jqp65CY7JeI642YIENVSSDsp4Ttlokg67CUPC9hPuulvCDrtpnsl6wg67O07JWY7Iq164uI64ukLjwvcD4NCjxwPuybjOuCmSDqsITri6jtlZwg7Iqk7YGs66a97Yq464uIIHNmdHDrpbwg7IKs7Jqp7ZWY7KeAIOyViuycvOyLnOuKlCDrtoTrk6TsnYAg7J6F66eb7JeQIOunnuqyjCBmdHDrgpggaHR0cOuTseydhCDsgqzsmqntlZjrj4TroZ0g67CU6r+UIOuztOyEuOyalC4gOik8L3A+IjtzOjEwOiJwb3N0X3RpdGxlIjtzOjQ1OiLtjIzsnbTsjazsnLzroZwgc2Z0cOyXkOyEnCBNUDNQIOyekOuPmSDqsLHsi6AiO319";}'
dsq_thread_id:
  - 722489103
categories:
  - Life
  - Music
  - Programming
tags:
  - paramiko
  - PuTTY
  - sftp
  - ssh
  - 라디오
  - 영어
  - 파이썬

---
많은 분들이 홈서버를 통해 mms 스트림을 녹음하고 계신 걸로 알고 있습니다.

저도 EBS 라디오가 mms서비스를 접기 전 까지 EBS 라디오를 통해 영어공부를 하는데 이를 활용하고 있었지요

> 그 방법은 고수민 님의 블로그 중 [라디오로 영어공부 제대로 하는 법][1]에 잘 나와 있습니다. 🙂

EBS 라디오는 홈페이지 개편 후에 &#8211; 바보같이도- ActiveX를 사용해 스트리밍 방송을 하고 있습니다.

> KLDP의 bushi님 께서 계속 리눅스박스에서 들을 수 있는 [길][2]을 열어 주셨습니다!! 감사합니다. (__)

하지만 본인은, 아니꼬와서, 그 즈음부터 시작한 English only 방송, [tbs eFM][3]의 [Out Of Bed with Travis][4]를 듣고 있습니다. tbs eFM의 방송들은 아직 DJ들이 서툴어 보이는 점도 있지만, 보다 실전 영어에 가까워 진 느낌이며, 음악도 틀어줍니다. 오예~

녹음방법은 [예전과 동일][5]합니다. 자세한 설명은 생략하고, tbs eFM의 mms 주소는 다음과 같습니다.

  * **mms://58.227.116.249/eFM**

자 그럼. 홈서버에 날자별로 mp3파일들이 쌓여 있게 되고, sftp를 통해 다운받아 MP3P로 옮겨 듣곤 하였습니다.

어우&#8230; 이게 은근히 귀찮길래 스크립트를 써 봤습니다.

<!--more-->

> 
다음 링크에서 다운 받으세요.

  * [**UpdateSongsFromSftp.py**][6]

제가 필요했던 기능들은 다음과 같습니다.

  * 원클릭으로 홈서버의 sftp를 통해 mp3파일들을 다운-갱신- 해 줄 것
  * mp3 플레이어에 넣고 다닐만큼 작을것
  * 윈도/리눅스에서 모두 실행 가능할 것

파이썬과 ssh2 라이브러리 [paramiko][7]를 사용하여 위의 조건을 모두 충족시킬 수 있었습니다.

> 윈도에서 paramiko를 사용하려며 PuTTY가 필요합니다. 그 밖에는 OS를 가리지 않고 동일한 코드로 동작합니다. 오예~

다음은 제 MP3P를 연결한 화면:

 <img height="242" width="420" src="https://homin.dev/asset/blog/image/mp3p_files.png" alt="" />

자동 업데이트 스크립트와 ssh2 개인키를 넣어두어 파이썬과 paramiko가 깔린 곳(제가 쓰는 PC들에는 모두 깔려 있습니다.)이라면 어디서든 준비완료 입니다. 추가 용량은 단 5k

윈도에선 파이썬 설치시 py 확장자가 파이썬 인터프리터에 연결되어 스크립트를 더블 클릭하는 것 만으로 실행 됩니다.

다음은 자동 업데이트 스크립트의 실행 장면:

<img height="229" width="419" src="https://homin.dev/asset/blog/image/mp3p_auto_update_via_sftp.png" alt="" /> 

3일만의 실행 화면이네요. 이전 파일들을 지우고 새 파일들 3개를 다운받고 있습니다. paramiko1.7.4 버젼부터는 sftp의 전송 상태를 CB 함수에 건네줄 수 있게 되어, [파이썬 소리바다 클라이언트에 사용되었던 CUI 진행 바][8]를 붙여 보았습니다.

워낙 간단한 스크립트니 sftp를 사용하지 않으시는 분들은 입맛에 맞게 ftp나 http등을 사용하도록 바꿔 보세요. 🙂

 [1]: http://ko.usmlelibrary.com/entry/radio-english
 [2]: http://kldp.org/node/95974
 [3]: http://tbsefm.seoul.kr/
 [4]: http://tbsefm.seoul.kr/efm/outbt_intro.jsp?id=outbt
 [5]: https://homin.dev/wp/?p=32
 [6]: https://homin.dev/svn/OneFiler/UpdateSongsFromSftp.py
 [7]: http://www.lag.net/paramiko/
 [8]: http://bbs.python.or.kr/viewtopic.php?t=14647